# BAT 脚本管理工具

一个基于 PyQt5 的 Android 设备管理和日志分析工具集，专为移动设备测试和开发设计。

## 📋 项目概述

BAT 工具集提供了一套完整的 Android 设备管理解决方案，包括设备监控、脚本执行、文件下载、日志分析等功能。主要面向移动设备测试工程师和开发人员。

## 🏗️ 项目结构

```
bat/
├── bat.py                 # 主程序 - 设备管理和脚本执行界面
├── analyzer.py            # 日志分析器 - 解析 Android 日志文件
├── merge_log.py           # 日志合并工具 - 图形界面版本
├── merge_text_logs.py     # 文本日志合并核心逻辑
├── rename.py              # 文件重命名工具
├── build.py               # 项目构建脚本
├── icon/                  # 图标资源目录
│   ├── bat.ico           # 主程序图标
│   ├── adb.ico           # ADB 相关图标
│   └── ...               # 其他功能图标
├── scrcpy/               # 屏幕录制工具
│   ├── scrcpy.exe        # 可执行文件
│   └── ...               # 相关依赖库
├── app_cache/            # 应用缓存目录
└── output/               # 构建输出目录
```

## 🚀 主要功能

### 1. 设备管理 (`bat.py`)
- **USB 设备实时监控**: 自动检测 Android 设备连接/断开
- **多设备支持**: 同时管理多个 Android 设备
- **设备命名**: 自定义设备显示名称
- **批量操作**: 支持多设备批量执行命令

### 2. 脚本执行系统
- **脚本管理**: 创建、编辑、删除自定义脚本
- **分类标签**: 按功能分类管理脚本（Qualcomm、其他平台）
- **批量执行**: 支持多设备同时执行脚本
- **进度监控**: 实时显示执行进度和状态

### 3. 文件下载功能
- **多路径下载**: 支持从多个设备路径下载文件
- **进度跟踪**: 实时显示下载进度
- **自动分类**: 按设备和时间自动组织下载文件
- **断点续传**: 支持中断后继续下载

### 4. 日志分析工具 (`analyzer.py`)
- **Android 日志解析**: 解析各种 Android 日志格式
- **多日志类型支持**: Main、System、Radio、Events、Crash 日志
- **压缩支持**: 支持压缩日志文件处理
- **时间戳排序**: 按时间顺序整理日志条目

### 5. 日志合并工具 (`merge_log.py`, `merge_text_logs.py`)
- **多文件合并**: 将多个日志文件合并为单一文件
- **时间排序**: 按时间戳自动排序日志条目
- **内存优化**: 支持大文件的内存优化处理
- **图形界面**: 提供友好的用户界面

### 6. 文件重命名工具 (`rename.py`)
- **批量重命名**: 支持大量文件的批量重命名
- **规则定制**: 自定义重命名规则和前缀
- **预览功能**: 重命名前预览结果
- **文件过滤**: 支持按类型过滤文件

## 🛠️ 技术栈

- **GUI 框架**: PyQt5
- **主题系统**: qt-material
- **设备监控**: WMI (Windows Management Instrumentation)
- **日志解析**: 自定义解析器 + ctypes
- **构建工具**: Nuitka / PyInstaller
- **平台支持**: Windows

## 📦 安装依赖

### 系统要求
- Windows 10/11
- Python 3.12+
- ADB (Android Debug Bridge)

### Python 依赖
```bash
pip install PyQt5
pip install qt-material
pip install wmi
```

### ADB 安装
1. 下载 Android SDK Platform Tools
2. 将 ADB 添加到系统 PATH
3. 确保设备已启用 USB 调试

## 🚀 快速开始

### 1. 运行主程序
```bash
python bat.py
```

### 2. 使用日志分析器
```bash
python analyzer.py
```

### 3. 使用日志合并工具
```bash
python merge_log.py
```

### 4. 使用文件重命名工具
```bash
python rename.py
```

## 📖 使用指南

### 设备管理
1. **连接设备**: 通过 USB 连接 Android 设备
2. **启用调试**: 在设备上启用 USB 调试模式
3. **设备识别**: 程序会自动检测并显示设备
4. **自定义名称**: 右键设备可自定义显示名称

### 脚本执行
1. **创建脚本**: 点击"添加脚本"按钮
2. **编辑命令**: 在对话框中输入 ADB 命令
3. **选择设备**: 勾选要执行脚本的设备
4. **执行脚本**: 点击"执行"按钮开始执行

### 文件下载
1. **选择源路径**: 在设备上选择要下载的文件夹
2. **设置目标**: 选择本地保存路径
3. **配置选项**: 设置子文件夹命名规则
4. **开始下载**: 点击下载按钮开始传输

### 日志分析
1. **选择日志文件**: 使用文件选择器选择日志文件
2. **设置输出路径**: 选择解析后的文件保存位置
3. **开始解析**: 点击解析按钮开始处理
4. **查看结果**: 在输出目录查看解析后的日志

## 🔧 高级功能

### 批量操作
- 支持同时向多个设备发送命令
- 实时显示各设备执行状态
- 失败设备自动重试机制

### 自定义脚本
- 支持复杂的多步骤脚本
- 变量替换和参数化
- 脚本模板和预设

### 设备监控
- 实时监控 USB 设备变化
- 自动刷新设备列表
- 设备状态实时更新

## 🏗️ 构建和部署

### 使用 Nuitka 构建 (推荐)
```bash
python build.py
```

### 使用 PyInstaller 构建
```bash
pyinstaller -w bat.py
```

## ⚠️ 注意事项

1. **权限要求**: 需要管理员权限进行设备监控
2. **防火墙**: 确保防火墙允许 ADB 通信
3. **驱动安装**: 确保设备驱动正确安装
4. **USB 调试**: 设备必须启用 USB 调试模式

## 🐛 故障排除

### 设备无法识别
- 检查 USB 调试是否启用
- 确认设备驱动已安装
- 尝试更换 USB 端口或线缆

### 脚本执行失败
- 检查 ADB 连接状态
- 确认命令语法正确
- 查看错误日志获取详细信息

### 文件下载中断
- 检查存储空间是否充足
- 确认网络连接稳定
- 尝试重新连接设备

## 📄 许可证

本项目采用自定义许可证，详见代码文件头部声明。

## 👥 贡献

欢迎提交 Issue 和 Pull Request 来改进项目。

## 📞 支持

如有问题或建议，请通过以下方式联系：
- 提交 GitHub Issue
- 发送邮件至项目维护者

---

**版本**: 3.8.3.0  
**最后更新**: 2025年  
**维护者**: BarryChen
